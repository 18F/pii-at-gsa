---
permalink: /
layout: wide
title: Home
---
<script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
<script>

$(document).ready( function () {
  var options = {
    valueNames: [ 'system', 'sorn-id', 'pii', 'type' ],
    page: 10,
    pagination: true
  };

  var list = new List('cards', options);

  const systemSearch = $("#system-field");
  const sornSearch = $("#sorn-field");
  const piiSearch = $("#pii-field");
  const piaCheckbox = $("#filter__PIA")
  const sornCheckbox = $("#filter__SORNS")
  const searches = [systemSearch, sornSearch, piiSearch]
  const checkboxes = [piaCheckbox, sornCheckbox]

  function getSearchValues() {
    return searchValues = {
      system: systemSearch.val().toLowerCase(),
      sorn: sornSearch.val().toLowerCase(),
      pii: piiSearch.val().toLowerCase()
    }
  }

  function filter(searchValues) {
    list.filter( function(item) {

      var systemName = item.values()["system"].toLowerCase()
      var sornID = item.values()["sorn-id"].toLowerCase()
      var piiValue = item.values()["pii"].toLowerCase()
      var type = item.values()["type"]

      var systemFilter = systemName.includes(searchValues.system) || !searchValues.system
      var sornIdFilter = sornID.includes(searchValues.sorn) || !searchValues.sorn
      var piiFilter = piiValue.includes(searchValues.pii) || !searchValues.pii
      var piaFilter = true
      var sornFilter = true

      if (piaCheckbox.is(":checked")) {
        //pass
      } else {
        piaFilter = !type.includes("PIA")
      }

      if (sornCheckbox.is(":checked")) {
        //pass
      } else {
        sornFilter = !type.includes("SORN")
      }

      if (systemFilter && sornIdFilter && piiFilter && piaFilter && sornFilter) {
        return true;
      } else {
        return false;
      }
    })
  }

  function activeFilter(key) {
    // key is one of the keys of searchValues
    // system, sorn, or pii
    keyTag = `#${key}-tag`
    var tagExists = $(keyTag).length;
    if (searchValues[key] && !tagExists) {
      html = `<li id="${key}-tag" class="usa-tag">System Name: ${searchValues[key]}</li>`
      $("#active-filters").append(html)
    } else if (searchValues[key] && tagExists) {
      $(`#${key}-tag`).text(`${key}: ${searchValues[key]}`)
    } else if (!searchValues[key] && tagExists) {
      $(`#${key}-tag`).remove()
    }
  }

  checkboxes.forEach(
    checkbox => checkbox.click( function() {
      searchValues = getSearchValues()
      getSearchValues
      filter(searchValues)
      list.on('filterComplete', function() {
        $("#result-count").text(list.matchingItems.length)
      })
    })
  )

  // const searches = [systemSearch, sornSearch, piiSearch]
  // Bind keypresses on each of the search boxes
  searches.forEach(
    search => search.keyup( function() {

      // Get contents of the search boxes
      searchValues = getSearchValues()

      // filter the main list
      filter(searchValues)

      // after filter, get the result count
      list.on('filterComplete', function() {
        $("#result-count").text(list.matchingItems.length)
      })

      // Make the active filter tags for each search box
      Object.keys(searchValues).forEach(
        key => activeFilter(key)
      )
    })
  )
})

</script>

  <div class="grid-container">
    <div class="grid-row grid-gap">
      <div class="filter_section usa-list desktop:grid-col-3">
        <ul>
          <li>
            <span><strong>FILTERS</strong></span>
          </li>
          <li>
            <span>QUICK FILTERS</span>
          </li>
          <li>
            <span class="usa-tag">
              <input type="checkbox" name="SSN" value="SSN">
              <label for="SSN">SSN</label>
            </span>
            <span class="usa-tag">
              <input type="checkbox" name="Email" value="Email">
              <label for="Email">email</label>
            </span>
          </li>
          <li>
            <span>CUSTOM FILTERS</span>
          </li>
          <li>
            <span><strong>TYPE</strong></span>
          </li>
          <li>
            <div class="usa-checkbox float-left margin-right-2">
              <input class="usa-checkbox__input" type="checkbox" id="filter__SORNS" name="SORN" value="SORN" checked>
              <label class="usa-checkbox__label" for="filter__SORNS">SORN</label>
            </div>
          </li>
          <li>
            <div class="usa-checkbox float-left">
              <input class="usa-checkbox__input" type="checkbox" id="filter__PIA" name="PIA" value="PIA" checked>
              <label class="usa-checkbox__label" for="filter__PIA">PIA</label>
            </div>
          </li>
        </ul>
        <br>
        <ul>
          <li>
            <label class="" for="search-field">System</label>
            <input class="usa-input" id="system-field" type="input" name="system">
          </li>
          <li>
            <label class="" for="search-field">SORN ID</label>
            <input class="usa-input" id="sorn-field" type="input" name="sorn id">
          </li>
          <li>
            <label class="" for="search-field">PII</label>
            <input class="usa-input" id="pii-field" type="input" name="PII">
          </li>
        </ul>

      </div> <!--filter_section-->

      <main class="usa-layout-docs__main desktop:grid-col-9 usa-prose usa-layout-docs" id="main-content">
        <div class="grid-row margin-2 margin-right-0 results-meta">
          <div class="grid-col-9 display-inline results-meta__filters">
            <span class="font-body-xs text-uppercase text-bold text-ls-1 "> Active filters: </span>
            <ul id="active-filters" class="margin-top-05 margin-bottom-05 padding-0">
            </ul>
          </div>

          <div class="grid-col-3 margin-bottom-0 text-right results-meta__count">
            <span class="font-body-xs">
            {% assign rows = site.data.pii-inventory | sort: "System Name" %}
            Matching <span id="result-count" class="text-bold">{{ rows.size - 1 }}</span> of <span class="text-bold">{{ rows.size - 1 }}</span>
            </span>
          </div>
        </div>
        <hr class="margin-left-2 maring-right-0">
        <div id="cards">
          <div class="list">

          {% for row in rows %}
            <div class="card padding-2 margin-2 margin-right-0">
              <div class="grid-row margin-bottom-105">
                <span class="system font-heading-lg text-blue">{{ row['System Name'] }}</span>
              </div>
              <!-- <ul class="padding-0"> -->
                <div class="grid-row margin-bottom-105">
                  <div class="grid-col-2">
                    <strong style="color:#5B5B5B">Type:</strong>
                  </div>
                  <div class="type grid-col-10">
                    {{ row['Type'] }}
                  </div>
                </div>
                <div class="grid-row margin-bottom-105">
                  <div class="grid-col-2">
                    <strong style="color:#5B5B5B">SORN ID:</strong>
                  </div>
                  <div class="sorn-id grid-col-10">
                    {{ row['SORN ID']}}
                  </div>
                </div>
              <!-- </div> -->

              <div class="grid-row margin-bottom-105">
                <div class="grid-col-2">
                  {% if row['Type'] == "SORN"%}
                  <strong style="color:#5B5B5B">Categories<br>of Record:</strong>
                  {% else %}
                  <strong style="color:#5B5B5B">PII:</strong>
                  {% endif %}
                </div>
                <div class="grid-col-10">
                  <ul class="pii">
                    {% assign pii = row['PII'] | split: "," | sort_natural %}
                    {% for i in pii %}
                      <li>{{i}}</li>
                    {% endfor %}
                  </ul>
                </div>
              </div>


              <a href="{{ row['URL'] }}" target="_blank" class="usa-link">Source</a>

            </div>
          {% endfor %}
          </div>
          <ul class="pagination float-right"></ul>
        </div>
      </main>



    </div> <!--grid-row-->
  </div> <!--grid-container-->
